stages:
  - static-test
  - dynamic-test

running_pipelines:
  stage: static-test
  script:
    - echo "Running pipelines"

lint_vibe_client:
  stage: static-test
  rules:
    - if: '$CI_PIPELINE_SOURCE == "merge_request_event"'
      changes:
        - vibe-client/**/*
  script:
    - cd vibe-client
    - npx eslint

lint_vibe_server:
  stage: static-test
  rules:
    - if: '$CI_PIPELINE_SOURCE == "merge_request_event"'
      changes:
        - vibe-server/**/*
  script:
    - cd vibe-server
    - npx eslint

build_vibe_client:
  stage: dynamic-test
  image: node:18
  rules:
    - if: '$CI_PIPELINE_SOURCE == "merge_request_event"'
      changes:
        - vibe-client/**/*
  script:
    - echo "Building vibe-client"
    - cd vibe-client
    - npm install
    - npm run build
